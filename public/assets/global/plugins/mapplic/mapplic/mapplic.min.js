(function(b){var a=function(){var m=this;m.o={source:"locations.json",selector:"[id^=landmarks] > *",landmark:null,mapfill:false,height:420,markers:true,minimap:true,sidebar:true,search:true,deeplinking:true,clearbutton:true,zoombuttons:true,hovertip:true,smartip:true,fullscreen:false,developer:false,maxscale:4,skin:"",zoom:true};m.init=function(x,z){m.o=b.extend(m.o,z);m.x=0;m.y=0;m.scale=1;m.el=x.addClass("mapplic-element mapplic-loading").addClass(m.o.skin).height(m.o.height);if(m.o.landmark){m.o.sidebar=false;m.o.zoombuttons=false;m.o.deeplinking=false}if(typeof m.o.source==="string"){b.getJSON(m.o.source,function(A){d(A);m.el.removeClass("mapplic-loading")}).fail(function(){console.error("Couldn't load map data. (Make sure you are running the script through a server and not just opening the html file with your browser)");m.el.removeClass("mapplic-loading").addClass("mapplic-error");alert("Data file missing or invalid!")})}else{d(m.o.source);m.el.removeClass("mapplic-loading")}return m};function p(){this.el=null;this.shift=6;this.drop=0;this.location=null;this.init=function(){var x=this;this.el=b("<div></div>").addClass("mapplic-tooltip");this.close=b("<a></a>").addClass("mapplic-tooltip-close").attr("href","#").appendTo(this.el);this.close.on("click touchend",function(z){z.preventDefault();b(".mapplic-active",m.el).attr("class","mapplic-clickable");if(m.deeplinking){m.deeplinking.clear()}if(!m.o.zoom){l(0.5,0.5,1,600,"easeInOutCubic")}x.hide()});this.image=b("<img>").addClass("mapplic-tooltip-image").hide().appendTo(this.el);this.title=b("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.el);this.content=b("<div></div>").addClass("mapplic-tooltip-content").appendTo(this.el);this.desc=b("<div></div>").addClass("mapplic-tooltip-description").appendTo(this.content);this.link=b("<a>More</a>").addClass("mapplic-tooltip-link").attr("href","#").hide().appendTo(this.el);this.triangle=b("<div></div>").addClass("mapplic-tooltip-triangle").prependTo(this.el);m.map.append(this.el)};this.set=function(x){if(x){var z=this;if(x.image){this.image.attr("src",x.image).show()}else{this.image.hide()}if(x.link){this.link.attr("href",x.link).show()}else{this.link.hide()}this.title.text(x.title);this.desc.html(x.description);this.content[0].scrollTop=0;this.position(x)}};this.show=function(x){if(x){if(x.action=="none"){this.el.stop().fadeOut(300);return}var z=this;this.location=x;m.hovertip.hide();if(x.image){this.image.attr("src",x.image).show()}else{this.image.hide()}if(x.link){this.link.attr("href",x.link).show()}else{this.link.hide()}this.title.text(x.title);this.desc.html(x.description);var A=b('.mapplic-pin[data-location="'+x.id+'"]');if(A.length==0){this.shift=20}else{this.shift=A.height()+10}b("img",this.el).load(function(){z.position()});this.position();this.el.stop().show()}};this.position=function(){if(this.location){var A=m.map.offset().left+m.map.width()*this.location.x-m.container.offset().left,F=m.map.offset().top+m.map.height()*this.location.y-m.container.offset().top;var z=this.location.x*100,E=this.location.y*100,C=-this.el.outerHeight()-this.shift,D=-this.el.outerWidth()/2;if(m.o.smartip){var B=0.5;if(Math.abs(C)>F){C=8+2;this.el.addClass("mapplic-bottom")}else{this.el.removeClass("mapplic-bottom")}if(this.el.outerWidth()/2>A){B=0.5-(this.el.outerWidth()/2-A)/this.el.outerWidth()}else{if((m.container.width()-A-this.el.outerWidth()/2)<0){B=0.5+(A+this.el.outerWidth()/2-m.container.width())/this.el.outerWidth()}}B=Math.max(0,Math.min(1,B));D=-this.el.outerWidth()*B;this.triangle.css("left",Math.max(5,Math.min(95,B*100))+"%")}this.el.css({left:z+"%",top:E+"%",marginTop:C,marginLeft:D});this.drop=240+this.shift}};this.hide=function(){var x=this;this.location=null;this.el.stop().fadeOut(300,function(){x.desc.empty()})}}function v(){this.el=null;this.shift=6;this.init=function(){var x=this;this.el=b("<div></div>").addClass("mapplic-tooltip mapplic-hovertip");this.title=b("<h4></h4>").addClass("mapplic-tooltip-title").appendTo(this.el);this.triangle=b("<div></div>").addClass("mapplic-tooltip-triangle").appendTo(this.el);b(m.map).on("mouseover",".mapplic-layer a",function(){var A="";if(b(this).hasClass("mapplic-pin")){A=b(this).data("location");x.shift=b(this).height()+10}else{A=b(this).attr("xlink:href").slice(1);x.shift=20}var z=f(A);if(z){x.show(z)}}).on("mouseout",function(){x.hide()});if(m.o.selector){b(m.map).on("mouseover",m.o.selector,function(){var z=f(b(this).attr("id"));x.shift=20;if(z){x.show(z)}}).on("mouseout",function(){x.hide()})}m.map.append(this.el)};this.show=function(x){if(m.tooltip.location!=x){this.title.text(x.title);this.position(x);this.el.stop().fadeIn(100)}};this.position=function(B){var A=m.map.offset().left+m.map.width()*B.x-m.container.offset().left,G=m.map.offset().top+m.map.height()*B.y-m.container.offset().top;var z=B.x*100,F=B.y*100,D=-this.el.outerHeight()-this.shift,E=0;var C=0.5;if(Math.abs(D)>G){D=8+2;this.el.addClass("mapplic-bottom")}else{this.el.removeClass("mapplic-bottom")}if(this.el.outerWidth()/2>A){C=0.5-(this.el.outerWidth()/2-A)/this.el.outerWidth()}else{if((m.container.width()-A-this.el.outerWidth()/2)<0){C=0.5+(A+this.el.outerWidth()/2-m.container.width())/this.el.outerWidth()}}E=-this.el.outerWidth()*C;this.triangle.css("left",Math.max(10,Math.min(90,C*100))+"%");this.el.css({left:z+"%",top:F+"%",marginTop:D,marginLeft:E})};this.hide=function(){this.el.stop().fadeOut(200)}}function r(){this.param="location";this.init=function(){var x=this;this.check(0);window.onpopstate=function(z){if(z.state){x.check(600)}return false}};this.check=function(x){var z=this.getUrlParam(this.param);h(z,x,true)};this.getUrlParam=function(x){x=x.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var A=new RegExp("[\\?&]"+x+"=([^&#]*)"),z=A.exec(location.search);return z===null?"":decodeURIComponent(z[1].replace(/\+/g," "))};this.update=function(z){var x=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+this.param+"="+z;window.history.pushState({path:x},"",x)};this.clear=function(){history.pushState("",document.title,window.location.pathname)}}function t(){this.param="location";this.init=function(){var x=this;this.check(0);b(window).on("hashchange",function(){x.check(600)})};this.check=function(x){var z=location.hash.slice(this.param.length+2);h(z,x,true)};this.update=function(x){window.location.hash=this.param+"-"+x};this.clear=function(){window.location.hash=this.param}}function g(){this.el=null;this.opacity=null;this.init=function(){this.el=b("<div></div>").addClass("mapplic-minimap").appendTo(m.container);this.el.css("height",this.el.width()*m.hw_ratio);this.el.click(function(A){A.preventDefault();var z=(A.pageX-b(this).offset().left)/b(this).width(),B=(A.pageY-b(this).offset().top)/b(this).height();l(z,B,m.scale/m.fitscale,100)})};this.addLayer=function(z){var x=b("<div></div>").addClass("mapplic-minimap-layer").addClass(z.id).appendTo(this.el);b("<img>").attr("src",z.minimap).addClass("mapplic-minimap-background").appendTo(x);b("<div></div>").addClass("mapplic-minimap-overlay").appendTo(x);b("<img>").attr("src",z.minimap).addClass("mapplic-minimap-active").appendTo(x)};this.show=function(x){b(".mapplic-minimap-layer",this.el).hide();b(".mapplic-minimap-layer."+x,this.el).show()};this.update=function(F,D){var C=b(".mapplic-minimap-active",this.el);if(F===undefined){F=m.x}if(D===undefined){D=m.y}var A=Math.round(m.container.width()/m.contentWidth/m.scale*this.el.width()),H=Math.round(m.container.height()/m.contentHeight/m.scale*this.el.height()),E=Math.round(-D/m.contentHeight/m.scale*this.el.height()),B=Math.round(-F/m.contentWidth/m.scale*this.el.width()),G=B+A,z=E+H;C.each(function(){b(this)[0].style.clip="rect("+E+"px, "+G+"px, "+z+"px, "+B+"px)"});var I=this;this.el.show();this.el.css("opacity",1);clearTimeout(this.opacity);this.opacity=setTimeout(function(){I.el.css("opacity",0);setTimeout(function(){I.el.hide()},600)},2000)}}function c(){this.el=null;this.list=null;this.init=function(){var z=this;this.el=b("<div></div>").addClass("mapplic-sidebar").appendTo(m.el);if(m.o.search){var A=b("<form></form>").addClass("mapplic-search-form").submit(function(){return false}).appendTo(this.el);m.clear=b("<button></button>").addClass("mapplic-search-clear").click(function(){x.val("");x.keyup()}).appendTo(A);var x=b("<input>").attr({type:"text",spellcheck:"false",placeholder:"Search..."}).addClass("mapplic-search-input").keyup(function(){var C=b(this).val();z.search(C)}).prependTo(A)}var B=b("<div></div>").addClass("mapplic-list-container").appendTo(this.el);this.list=b("<ol></ol>").addClass("mapplic-list").appendTo(B);this.notfound=b("<p></p>").addClass("mapplic-not-found").text("Nothing found. Please try a different search.").appendTo(B);if(!m.o.search){B.css("padding-top","0")}};this.addCategories=function(x){var z=this.list;if(x){b.each(x,function(B,E){var D=b("<li></li>").addClass("mapplic-list-category").attr("data-category",E.id);var A=b("<ol></ol>").css("border-color",E.color).appendTo(D);if(E.show=="false"){A.hide()}else{D.addClass("mapplic-opened")}var C=b("<a></a>").attr("href","#").attr("title",E.title).css("background-color",E.color).text(E.title).prependTo(D);C.on("click",function(F){F.preventDefault();D.toggleClass("mapplic-opened");A.slideToggle(200)});if(E.icon){b("<img>").attr("src",E.icon).addClass("mapplic-list-thumbnail").prependTo(C)}b("<span></span>").text("0").addClass("mapplic-list-count").prependTo(C);z.append(D)})}};this.addLocation=function(B){var A=b("<li></li>").addClass("mapplic-list-location").addClass("mapplic-list-shown");var z=b("<a></a>").attr("href","#").click(function(C){C.preventDefault();h(B.id,600);if(b(window).width()<668){b("html, body").animate({scrollTop:m.container.offset().top},400)}}).appendTo(A);if(B.thumbnail){b("<img>").attr("src",B.thumbnail).addClass("mapplic-list-thumbnail").appendTo(z)}b("<h4></h4>").text(B.title).appendTo(z);b("<span></span>").html(B.about).appendTo(z);var x=b('.mapplic-list-category[data-category="'+B.category+'"]');if(x.length){b("ol",x).append(A)}else{this.list.append(A)}b(".mapplic-list-count",x).text(b(".mapplic-list-shown",x).length)};this.search=function(x){if(x){m.clear.fadeIn(100)}else{m.clear.fadeOut(100)}b(".mapplic-list li",m.el).each(function(){if(b(this).text().search(new RegExp(x,"i"))<0){b(this).removeClass("mapplic-list-shown");b(this).slideUp(200)}else{b(this).addClass("mapplic-list-shown");b(this).show()}});b(".mapplic-list > li",m.el).each(function(){var z=b(".mapplic-list-shown",this).length;b(".mapplic-list-count",this).text(z)});if(b(".mapplic-list > li.mapplic-list-shown").length>0){this.notfound.fadeOut(200)}else{this.notfound.fadeIn(200)}}}function j(){this.el=null;this.init=function(){this.el=b("<div></div>").addClass("mapplic-coordinates").appendTo(m.container);this.el.append("x: ");b("<code></code>").addClass("mapplic-coordinates-x").appendTo(this.el);this.el.append(" y: ");b("<code></code>").addClass("mapplic-coordinates-y").appendTo(this.el);b(".mapplic-layer",m.map).on("mousemove",function(A){var z=(A.pageX-m.map.offset().left)/m.map.width(),B=(A.pageY-m.map.offset().top)/m.map.height();b(".mapplic-coordinates-x").text(parseFloat(z).toFixed(4));b(".mapplic-coordinates-y").text(parseFloat(B).toFixed(4))})}}function n(){this.el=null;this.init=function(){this.el=b("<a></a>").attr("href","#").addClass("mapplic-clear-button").appendTo(m.container);this.el.on("click touchstart",function(x){x.preventDefault();if(m.deeplinking){m.deeplinking.clear()}b(".mapplic-active",m.el).attr("class","mapplic-clickable");m.tooltip.hide();l(0.5,0.5,1,400,"easeInOutCubic")})}}function k(){this.el=null;this.init=function(){this.el=b("<div></div>").addClass("mapplic-zoom-buttons").appendTo(m.container);this.zoomin=b("<a></ha>").attr("href","#").addClass("mapplic-zoomin-button").appendTo(this.el);this.zoomin.on("click touchstart",function(x){x.preventDefault();var z=m.scale;m.scale=o(z+z*0.8);m.x=u(m.x-(m.container.width()/2-m.x)*(m.scale/z-1));m.y=s(m.y-(m.container.height()/2-m.y)*(m.scale/z-1));i(m.x,m.y,m.scale,400,"easeInOutCubic")});this.zoomout=b("<a></ha>").attr("href","#").addClass("mapplic-zoomout-button").appendTo(this.el);this.zoomout.on("click touchstart",function(x){x.preventDefault();var z=m.scale;m.scale=o(z-z*0.4);m.x=u(m.x-(m.container.width()/2-m.x)*(m.scale/z-1));m.y=s(m.y-(m.container.height()/2-m.y)*(m.scale/z-1));i(m.x,m.y,m.scale,400,"easeInOutCubic")})};this.update=function(x){this.zoomin.removeClass("mapplic-disabled");this.zoomout.removeClass("mapplic-disabled");if(x==m.fitscale){this.zoomout.addClass("mapplic-disabled")}else{if(x==m.o.maxscale){this.zoomin.addClass("mapplic-disabled")}}}}function w(){this.el=null;this.init=function(){var x=this;this.element=m.el[0];b("<a></a>").attr("href","#").attr("href","#").addClass("mapplic-fullscreen-button").click(function(z){z.preventDefault();if(x.isFull()){x.exitFull()}else{x.goFull()}}).appendTo(m.container)};this.goFull=function(){if(this.element.requestFullscreen){this.element.requestFullscreen()}else{if(this.element.mozRequestFullScreen){this.element.mozRequestFullScreen()}else{if(this.element.webkitRequestFullscreen){this.element.webkitRequestFullscreen()}else{if(this.element.msRequestFullscreen){this.element.msRequestFullscreen()}}}}};this.exitFull=function(){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}};this.isFull=function(){if(window.innerHeight==screen.height){return true}else{return false}}}var d=function(B){m.data=B;var z=0;var A;m.container=b("<div></div>").addClass("mapplic-container").appendTo(m.el);m.map=b("<div></div>").addClass("mapplic-map").appendTo(m.container);if(m.o.zoom){m.map.addClass("mapplic-zoomable")}m.levelselect=b("<select></select>").addClass("mapplic-levels-select");if(!m.o.sidebar){m.container.css("width","100%")}m.contentWidth=parseInt(B.mapwidth);m.contentHeight=parseInt(B.mapheight);m.hw_ratio=B.mapheight/B.mapwidth;m.map.css({width:B.mapwidth,height:B.mapheight});if(m.o.minimap){m.minimap=new g();m.minimap.init()}if(m.o.sidebar){m.sidebar=new c();m.sidebar.init();m.sidebar.addCategories(B.categories)}if(B.levels){b.each(B.levels,function(D,G){var F=G.map;var H=F.substr((F.lastIndexOf(".")+1)).toLowerCase();var E=b("<div></div>").addClass("mapplic-layer").addClass(G.id).hide().appendTo(m.map);switch(H){case"jpg":case"jpeg":case"png":case"gif":b("<img>").attr("src",F).addClass("mapplic-map-image").appendTo(E);break;case"svg":b("<div></div>").addClass("mapplic-map-image").load(F,function(){b(m.o.selector,this).each(function(){var I=f(b(this).attr("id"));if(I){b(this).attr("class","mapplic-clickable");I.onmap=b(this);if(I.fill){b(this).css("fill",I.fill);b("path",this).css("fill",I.fill)}if(m.o.landmark===I.id){b(this).attr("class","mapplic-active")}}});b(m.o.selector).on("click touchend",function(){if(!m.dragging){var I=b(this).attr("id");h(I,600)}});b("svg a",this).each(function(){var I=f(b(this).attr("xlink:href").substr(1));if(I){b(this).attr("class","mapplic-clickable");I.onmap=b(this)}});b("svg a",this).click(function(I){var J=b(this).attr("xlink:href").substr(1);h(J,600);I.preventDefault()})}).appendTo(E);break;default:alert("File type "+H+" is not supported!")}if(m.minimap){m.minimap.addLayer(G)}m.levelselect.prepend(b("<option></option>").attr("value",G.id).text(G.title));if(!A||G.show){A=G.id}b.each(G.locations,function(J,K){var N=K.y*100;var M=K.x*100;if(K.pin!="hidden"){if(m.o.markers){var L="#";if(K.action=="redirect"){L=K.link}var I=b("<a></a>").attr("href",L).addClass("mapplic-pin").css({top:N+"%",left:M+"%"}).appendTo(E);I.on("click touchend",function(O){O.preventDefault();h(K.id,600)});if(K.fill){I.css("background-color",K.fill)}I.attr("data-location",K.id);I.addClass(K.pin)}}if(m.sidebar){m.sidebar.addLocation(K)}});z++})}m.tooltip=new p();m.tooltip.init();if(m.o.hovertip){m.hovertip=new v();m.hovertip.init()}if(m.o.developer){m.devtools=new j().init()}if(m.o.clearbutton){m.clearbutton=new n().init()}if(m.o.zoombuttons){m.zoombuttons=new k();m.zoombuttons.init();if(!m.o.clearbutton){m.zoombuttons.el.css("bottom","0")}}if(m.o.fullscreen){m.fullscreen=new w().init()}if(z>1){m.levels=b("<div></div>").addClass("mapplic-levels");var x=b('<a href="#"></a>').addClass("mapplic-levels-up").appendTo(m.levels);m.levelselect.appendTo(m.levels);var C=b('<a href="#"></a>').addClass("mapplic-levels-down").appendTo(m.levels);m.container.append(m.levels);m.levelselect.change(function(){var D=b(this).val();e(D)});x.click(function(D){D.preventDefault();if(!b(this).hasClass("mapplic-disabled")){e("+")}});C.click(function(D){D.preventDefault();if(!b(this).hasClass("mapplic-disabled")){e("-")}})}e(A);b(window).resize(function(){if(b(window).width()<668){m.container.height(b(window).height()-66)}else{m.container.height("100%")}var D=m.container.width()/m.contentWidth,E=m.container.height()/m.contentHeight;if(m.o.mapfill){if(D>E){m.fitscale=D}else{m.fitscale=E}}else{if(D<E){m.fitscale=D}else{m.fitscale=E}}m.scale=o(m.scale);m.x=u(m.x);m.y=s(m.y);i(m.x,m.y,m.scale,100)}).resize();if(m.o.landmark){h(m.o.landmark,0)}else{l(0.5,0.5,1,0)}if(m.o.deeplinking){if(history.pushState){m.deeplinking=new r()}else{m.deeplinking=new t()}m.deeplinking.init()}if(m.o.zoom){q()}};var q=function(){var B=m.map,A=b(".mapplic-map-image",m.map);document.ondragstart=function(){return false};A.on("mousedown",function(D){m.dragging=false;B.stop();B.data("mouseX",D.pageX);B.data("mouseY",D.pageY);B.data("lastX",m.x);B.data("lastY",m.y);B.addClass("mapplic-dragging");m.map.on("mousemove",function(F){m.dragging=true;var E=F.pageX-B.data("mouseX")+m.x;y=F.pageY-B.data("mouseY")+m.y;E=u(E);y=s(y);i(E,y);B.data("lastX",E);B.data("lastY",y)});b(document).on("mouseup",function(E){m.x=B.data("lastX");m.y=B.data("lastY");m.map.off("mousemove");b(document).off("mouseup");B.removeClass("mapplic-dragging")})});b(document).on("dblclick",".mapplic-map-image",function(D){D.preventDefault();var E=m.scale;m.scale=o(E*2);m.x=u(m.x-(D.pageX-m.container.offset().left-m.x)*(m.scale/E-1));m.y=s(m.y-(D.pageY-m.container.offset().top-m.y)*(m.scale/E-1));i(m.x,m.y,m.scale,400,"easeInOutCubic")});b(".mapplic-layer",m.el).bind("mousewheel DOMMouseScroll",function(D,F){D.preventDefault();var E=m.scale;m.scale=o(E+E*F/5);m.x=u(m.x-(D.pageX-m.container.offset().left-m.x)*(m.scale/E-1));m.y=s(m.y-(D.pageY-m.container.offset().top-m.y)*(m.scale/E-1));i(m.x,m.y,m.scale,200,"easeOutCubic")});if(!("ontouchstart" in window||"onmsgesturechange" in window)){return true}A.on("touchstart",function(D){m.dragging=false;var F=D.originalEvent,E=B.position();B.data("touchY",F.changedTouches[0].pageY-E.top);B.data("touchX",F.changedTouches[0].pageX-E.left);A.on("touchmove",function(H){H.preventDefault();m.dragging=true;var I=H.originalEvent;var G=I.touches.length;if(G==1){m.x=u(I.changedTouches[0].pageX-B.data("touchX"));m.y=s(I.changedTouches[0].pageY-B.data("touchY"));i(m.x,m.y,m.scale,50)}else{A.off("touchmove")}});A.on("touchend",function(G){A.off("touchmove touchend")})});var x=new Hammer(m.map[0],{transform_always_block:true,drag_block_horizontal:true,drag_block_vertical:true});m.map.on("touchstart",function(D){if(D.originalEvent.touches.length>1){x.get("pinch").set({enable:true})}});m.map.on("touchend",function(D){x.get("pinch").set({enable:false})});var C=1,z;x.on("pinchstart",function(D){m.dragging=false;C=m.scale/m.fitscale;z=C});x.on("pinch",function(D){m.dragging=true;if(D.scale!=1){C=Math.max(1,Math.min(z*D.scale,100))}var E=m.scale;m.scale=o(C*m.fitscale);m.x=u(m.x-(D.center.x-m.container.offset().left-m.x)*(m.scale/E-1));m.y=s(m.y-(D.center.y-m.y)*(m.scale/E-1));i(m.x,m.y,m.scale,100)})};var e=function(C,B){switch(C){case"+":C=b("option:selected",m.levelselect).removeAttr("selected").prev().prop("selected","selected").val();break;case"-":C=b("option:selected",m.levelselect).removeAttr("selected").next().prop("selected","selected").val();break;default:b('option[value="'+C+'"]',m.levelselect).prop("selected","selected")}var A=b(".mapplic-layer."+C,m.map);if(A.is(":visible")){return}if(!B){m.tooltip.hide()}b(".mapplic-layer:visible",m.map).hide();A.show();if(m.minimap){m.minimap.show(C)}var z=m.levelselect.get(0).selectedIndex,x=b(".mapplic-levels-up",m.levels),D=b(".mapplic-levels-down",m.levels);x.removeClass("mapplic-disabled");D.removeClass("mapplic-disabled");if(z==0){x.addClass("mapplic-disabled")}else{if(z==m.levelselect.get(0).length-1){D.addClass("mapplic-disabled")}}};var f=function(z){var x=null;b.each(m.data.levels,function(A,B){b.each(B.locations,function(C,D){if(D.id==z){x=D}})});return x};var h=function(A,z,x){b.each(m.data.levels,function(B,C){if(C.id==A){e(C.id,false);return false}b.each(C.locations,function(E,D){if(D.id==A){var G=0.5;if(!m.o.landmark){m.tooltip.set(D);m.tooltip.show(D);G=((m.container.height()-m.tooltip.drop)/2+m.tooltip.drop)/m.container.height()}var F=typeof D.zoom!=="undefined"?D.zoom:4;e(C.id,true);l(D.x,D.y,F,z,"easeInOutCubic",G);b(".mapplic-active",m.el).attr("class","mapplic-clickable");if(D.onmap){D.onmap.attr("class","mapplic-active")}if((m.o.deeplinking)&&(!x)){m.deeplinking.update(A)}return false}})})};var u=function(A){var z=m.container.width()-m.contentWidth*m.scale;if(z<0){if(A>0){A=0}else{if(A<z){A=z}}}else{A=z/2}return A};var s=function(z){var x=m.container.height()-m.contentHeight*m.scale;if(x<0){if(z>=0){z=0}else{if(z<x){z=x}}}else{z=x/2}return z};var o=function(x){if(x<m.fitscale){x=m.fitscale}else{if(x>m.o.maxscale){x=m.o.maxscale}}if(m.zoombuttons){m.zoombuttons.update(x)}return x};var l=function(z,E,A,C,D,B){C=typeof C!=="undefined"?C:400;B=typeof B!=="undefined"?B:0.5;m.scale=o(m.fitscale*A);m.x=u(m.container.width()*0.5-m.scale*m.contentWidth*z);m.y=s(m.container.height()*B-m.scale*m.contentHeight*E);i(m.x,m.y,m.scale,C,D)};var i=function(z,D,B,A,C){if(B!==undefined){m.map.stop().animate({left:z,top:D,width:m.contentWidth*B,height:m.contentHeight*B},A,C,function(){if(m.tooltip){m.tooltip.position()}})}else{m.map.css({left:z,top:D})}if(m.tooltip){m.tooltip.position()}if(m.minimap){m.minimap.update(z,D)}}};b.fn.mapplic=function(d){var c=this.length;return this.each(function(f){var h=b(this),g="mapplic"+(c>1?"-"+ ++f:""),e=(new a).init(h,d)})}})(jQuery);