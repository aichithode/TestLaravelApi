var TableDatatablesEditable=function(){var a=function(){function f(m,p){var n=m.fnGetData(p);var l=$(">td",p);for(var o=0,k=l.length;o<k;o++){m.fnUpdate(n[o],p,o,false)}m.fnDraw()}function c(l,n){var m=l.fnGetData(n);var k=$(">td",n);k[0].innerHTML='<input type="text" class="form-control input-small" value="'+m[0]+'">';k[1].innerHTML='<input type="text" class="form-control input-small" value="'+m[1]+'">';k[2].innerHTML='<input type="text" class="form-control input-small" value="'+m[2]+'">';k[3].innerHTML='<input type="text" class="form-control input-small" value="'+m[3]+'">';k[4].innerHTML='<a class="edit" href="">Save</a>';k[5].innerHTML='<a class="cancel" href="">Cancel</a>'}function d(k,m){var l=$("input",m);k.fnUpdate(l[0].value,m,0,false);k.fnUpdate(l[1].value,m,1,false);k.fnUpdate(l[2].value,m,2,false);k.fnUpdate(l[3].value,m,3,false);k.fnUpdate('<a class="edit" href="">Edit</a>',m,4,false);k.fnUpdate('<a class="delete" href="">Delete</a>',m,5,false);k.fnDraw()}function e(k,m){var l=$("input",m);k.fnUpdate(l[0].value,m,0,false);k.fnUpdate(l[1].value,m,1,false);k.fnUpdate(l[2].value,m,2,false);k.fnUpdate(l[3].value,m,3,false);k.fnUpdate('<a class="edit" href="">Edit</a>',m,4,false);k.fnDraw()}var j=$("#sample_editable_1");var g=j.dataTable({lengthMenu:[[5,15,20,-1],[5,15,20,"All"]],pageLength:5,language:{lengthMenu:" _MENU_ records"},columnDefs:[{orderable:true,targets:[0]},{searchable:true,targets:[0]}],order:[[0,"asc"]]});var i=$("#sample_editable_1_wrapper");var b=null;var h=false;$("#sample_editable_1_new").click(function(m){m.preventDefault();if(h&&b){if(confirm("Previose row not saved. Do you want to save it ?")){d(g,b);$(b).find("td:first").html("Untitled");b=null;h=false}else{g.fnDeleteRow(b);b=null;h=false;return}}var k=g.fnAddData(["","","","","",""]);var l=g.fnGetNodes(k[0]);c(g,l);b=l;h=true});j.on("click",".delete",function(l){l.preventDefault();if(confirm("Are you sure to delete this row ?")==false){return}var k=$(this).parents("tr")[0];g.fnDeleteRow(k);alert("Deleted! Do not forget to do some ajax to sync with backend :)")});j.on("click",".cancel",function(k){k.preventDefault();if(h){g.fnDeleteRow(b);b=null;h=false}else{f(g,b);b=null}});j.on("click",".edit",function(l){l.preventDefault();h=false;var k=$(this).parents("tr")[0];if(b!==null&&b!=k){f(g,b);c(g,k);b=k}else{if(b==k&&this.innerHTML=="Save"){d(g,b);b=null;alert("Updated! Do not forget to do some ajax to sync with backend :)")}else{c(g,k);b=k}}})};return{init:function(){a()}}}();jQuery(document).ready(function(){TableDatatablesEditable.init()});