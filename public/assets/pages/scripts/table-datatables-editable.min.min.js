var TableDatatablesEditable=function(){var b=function(){function n(c,f){var h=c.fnGetData(f);var d=$(">td",f);for(var g=0,e=d.length;g<e;g++){c.fnUpdate(h[g],f,g,false)}c.fnDraw()}function q(d,f){var c=d.fnGetData(f);var e=$(">td",f);e[0].innerHTML='<input type="text" class="form-control input-small" value="'+c[0]+'">';e[1].innerHTML='<input type="text" class="form-control input-small" value="'+c[1]+'">';e[2].innerHTML='<input type="text" class="form-control input-small" value="'+c[2]+'">';e[3].innerHTML='<input type="text" class="form-control input-small" value="'+c[3]+'">';e[4].innerHTML='<a class="edit" href="">Save</a>';e[5].innerHTML='<a class="cancel" href="">Cancel</a>'}function p(e,c){var d=$("input",c);e.fnUpdate(d[0].value,c,0,false);e.fnUpdate(d[1].value,c,1,false);e.fnUpdate(d[2].value,c,2,false);e.fnUpdate(d[3].value,c,3,false);e.fnUpdate('<a class="edit" href="">Edit</a>',c,4,false);e.fnUpdate('<a class="delete" href="">Delete</a>',c,5,false);e.fnDraw()}function o(e,c){var d=$("input",c);e.fnUpdate(d[0].value,c,0,false);e.fnUpdate(d[1].value,c,1,false);e.fnUpdate(d[2].value,c,2,false);e.fnUpdate(d[3].value,c,3,false);e.fnUpdate('<a class="edit" href="">Edit</a>',c,4,false);e.fnDraw()}var a=$("#sample_editable_1");var m=a.dataTable({lengthMenu:[[5,15,20,-1],[5,15,20,"All"]],pageLength:5,language:{lengthMenu:" _MENU_ records"},columnDefs:[{orderable:true,targets:[0]},{searchable:true,targets:[0]}],order:[[0,"asc"]]});var k=$("#sample_editable_1_wrapper");var r=null;var l=false;$("#sample_editable_1_new").click(function(c){c.preventDefault();if(l&&r){if(confirm("Previose row not saved. Do you want to save it ?")){p(m,r);$(r).find("td:first").html("Untitled");r=null;l=false}else{m.fnDeleteRow(r);r=null;l=false;return}}var e=m.fnAddData(["","","","","",""]);var d=m.fnGetNodes(e[0]);q(m,d);r=d;l=true});a.on("click",".delete",function(c){c.preventDefault();if(confirm("Are you sure to delete this row ?")==false){return}var d=$(this).parents("tr")[0];m.fnDeleteRow(d);alert("Deleted! Do not forget to do some ajax to sync with backend :)")});a.on("click",".cancel",function(c){c.preventDefault();if(l){m.fnDeleteRow(r);r=null;l=false}else{n(m,r);r=null}});a.on("click",".edit",function(c){c.preventDefault();l=false;var d=$(this).parents("tr")[0];if(r!==null&&r!=d){n(m,r);q(m,d);r=d}else{if(r==d&&this.innerHTML=="Save"){p(m,r);r=null;alert("Updated! Do not forget to do some ajax to sync with backend :)")}else{q(m,d);r=d}}})};return{init:function(){b()}}}();jQuery(document).ready(function(){TableDatatablesEditable.init()});