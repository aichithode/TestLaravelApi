var AppInbox=function(){var o=$(".inbox-content");var t="";var r=function(d,a){var b="app_inbox_inbox.html";var c=d.attr("data-title");t=a;App.blockUI({target:o,overlayColor:"none",animate:true});q(d);$.ajax({type:"GET",cache:false,url:b,dataType:"html",success:function(e){q(d);App.unblockUI(".inbox-content");$(".inbox-nav > li.active").removeClass("active");d.closest("li").addClass("active");$(".inbox-header > h1").text(c);o.html(e);if(Layout.fixContentHeight){Layout.fixContentHeight()}App.initUniform()},error:function(e,g,f){q(d)},async:false});jQuery("body").on("change",".mail-group-checkbox",function(){var e=jQuery(".mail-checkbox");var f=jQuery(this).is(":checked");jQuery(e).each(function(){$(this).attr("checked",f)});jQuery.uniform.update(e)})};var v=function(e,a,d){var b="app_inbox_view.html";App.blockUI({target:o,overlayColor:"none",animate:true});q(e);var c=e.parent("tr").attr("data-messageid");$.ajax({type:"GET",cache:false,url:b,dataType:"html",data:{message_id:c},success:function(f){App.unblockUI(o);q(e);if(d){$(".inbox-nav > li.active").removeClass("active")}$(".inbox-header > h1").text("View Message");o.html(f);Layout.fixContentHeight();App.initUniform()},error:function(f,h,g){q(e)},async:false})};var l=function(){$(".inbox-wysihtml5").wysihtml5({stylesheets:["../assets/global/plugins/bootstrap-wysihtml5/wysiwyg-color.css"]})};var p=function(){$("#fileupload").fileupload({url:"../assets/global/plugins/jquery-file-upload/server/php/",autoUpload:true});if($.support.cors){$.ajax({url:"../assets/global/plugins/jquery-file-upload/server/php/",type:"HEAD"}).fail(function(){$('<span class="alert alert-error"/>').text("Upload server currently unavailable - "+new Date()).appendTo("#fileupload")})}};var m=function(a){var b="app_inbox_compose.html";App.blockUI({target:o,overlayColor:"none",animate:true});q(a);$.ajax({type:"GET",cache:false,url:b,dataType:"html",success:function(c){App.unblockUI(o);q(a);$(".inbox-nav > li.active").removeClass("active");$(".inbox-header > h1").text("Compose");o.html(c);p();l();$(".inbox-wysihtml5").focus();Layout.fixContentHeight();App.initUniform()},error:function(c,e,d){q(a)},async:false})};var u=function(c){var b=$(c).attr("data-messageid");var a="app_inbox_reply.html";App.blockUI({target:o,overlayColor:"none",animate:true});q(c);$.ajax({type:"GET",cache:false,url:a,dataType:"html",success:function(d){App.unblockUI(o);q(c);$(".inbox-nav > li.active").removeClass("active");$(".inbox-header > h1").text("Reply");o.html(d);$('[name="message"]').val($("#reply_email_content_body").html());s();p();l();Layout.fixContentHeight();App.initUniform()},error:function(d,f,e){q(c)},async:false})};var s=function(){var a=$(".inbox-compose .mail-to .inbox-cc");var b=$(".inbox-compose .input-cc");a.hide();b.show();$(".close",b).click(function(){b.hide();a.show()})};var n=function(){var a=$(".inbox-compose .mail-to .inbox-bcc");var b=$(".inbox-compose .input-bcc");a.hide();b.show();$(".close",b).click(function(){b.hide();a.show()})};var q=function(a){if(typeof a=="undefined"){return}if(a.attr("disabled")){a.attr("disabled",false)}else{a.attr("disabled",true)}};return{init:function(){$(".inbox").on("click",".compose-btn",function(){m($(this))});$(".inbox").on("click",".inbox-discard-btn",function(a){a.preventDefault();r($(this),t)});$(".inbox").on("click",".reply-btn",function(){u($(this))});$(".inbox").on("click",".view-message",function(){v($(this))});$(".inbox-nav > li > a").click(function(){r($(this),"inbox")});$(".inbox-content").on("click",".mail-to .inbox-cc",function(){s()});$(".inbox-content").on("click",".mail-to .inbox-bcc",function(){n()});if(App.getURLParameter("a")==="view"){v()}else{if(App.getURLParameter("a")==="compose"){m()}else{$(".inbox-nav > li:first > a").click()}}}}}();jQuery(document).ready(function(){AppInbox.init()});