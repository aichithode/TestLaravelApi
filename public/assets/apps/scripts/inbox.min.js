var AppInbox=function(){var h=$(".inbox-content");var c="";var e=function(n,m){var l="app_inbox_inbox.html";var o=n.attr("data-title");c=m;App.blockUI({target:h,overlayColor:"none",animate:true});f(n);$.ajax({type:"GET",cache:false,url:l,dataType:"html",success:function(p){f(n);App.unblockUI(".inbox-content");$(".inbox-nav > li.active").removeClass("active");n.closest("li").addClass("active");$(".inbox-header > h1").text(o);h.html(p);if(Layout.fixContentHeight){Layout.fixContentHeight()}App.initUniform()},error:function(r,p,q){f(n)},async:false});jQuery("body").on("change",".mail-group-checkbox",function(){var q=jQuery(".mail-checkbox");var p=jQuery(this).is(":checked");jQuery(q).each(function(){$(this).attr("checked",p)});jQuery.uniform.update(q)})};var a=function(n,m,o){var l="app_inbox_view.html";App.blockUI({target:h,overlayColor:"none",animate:true});f(n);var p=n.parent("tr").attr("data-messageid");$.ajax({type:"GET",cache:false,url:l,dataType:"html",data:{message_id:p},success:function(q){App.unblockUI(h);f(n);if(o){$(".inbox-nav > li.active").removeClass("active")}$(".inbox-header > h1").text("View Message");h.html(q);Layout.fixContentHeight();App.initUniform()},error:function(s,q,r){f(n)},async:false})};var k=function(){$(".inbox-wysihtml5").wysihtml5({stylesheets:["../assets/global/plugins/bootstrap-wysihtml5/wysiwyg-color.css"]})};var g=function(){$("#fileupload").fileupload({url:"../assets/global/plugins/jquery-file-upload/server/php/",autoUpload:true});if($.support.cors){$.ajax({url:"../assets/global/plugins/jquery-file-upload/server/php/",type:"HEAD"}).fail(function(){$('<span class="alert alert-error"/>').text("Upload server currently unavailable - "+new Date()).appendTo("#fileupload")})}};var j=function(m){var l="app_inbox_compose.html";App.blockUI({target:h,overlayColor:"none",animate:true});f(m);$.ajax({type:"GET",cache:false,url:l,dataType:"html",success:function(n){App.unblockUI(h);f(m);$(".inbox-nav > li.active").removeClass("active");$(".inbox-header > h1").text("Compose");h.html(n);g();k();$(".inbox-wysihtml5").focus();Layout.fixContentHeight();App.initUniform()},error:function(p,n,o){f(m)},async:false})};var b=function(n){var l=$(n).attr("data-messageid");var m="app_inbox_reply.html";App.blockUI({target:h,overlayColor:"none",animate:true});f(n);$.ajax({type:"GET",cache:false,url:m,dataType:"html",success:function(o){App.unblockUI(h);f(n);$(".inbox-nav > li.active").removeClass("active");$(".inbox-header > h1").text("Reply");h.html(o);$('[name="message"]').val($("#reply_email_content_body").html());d();g();k();Layout.fixContentHeight();App.initUniform()},error:function(q,o,p){f(n)},async:false})};var d=function(){var m=$(".inbox-compose .mail-to .inbox-cc");var l=$(".inbox-compose .input-cc");m.hide();l.show();$(".close",l).click(function(){l.hide();m.show()})};var i=function(){var m=$(".inbox-compose .mail-to .inbox-bcc");var l=$(".inbox-compose .input-bcc");m.hide();l.show();$(".close",l).click(function(){l.hide();m.show()})};var f=function(l){if(typeof l=="undefined"){return}if(l.attr("disabled")){l.attr("disabled",false)}else{l.attr("disabled",true)}};return{init:function(){$(".inbox").on("click",".compose-btn",function(){j($(this))});$(".inbox").on("click",".inbox-discard-btn",function(l){l.preventDefault();e($(this),c)});$(".inbox").on("click",".reply-btn",function(){b($(this))});$(".inbox").on("click",".view-message",function(){a($(this))});$(".inbox-nav > li > a").click(function(){e($(this),"inbox")});$(".inbox-content").on("click",".mail-to .inbox-cc",function(){d()});$(".inbox-content").on("click",".mail-to .inbox-bcc",function(){i()});if(App.getURLParameter("a")==="view"){a()}else{if(App.getURLParameter("a")==="compose"){j()}else{$(".inbox-nav > li:first > a").click()}}}}}();jQuery(document).ready(function(){AppInbox.init()});